local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
print("ğŸ¯ Sniper Aimbot Script BaÅŸlatÄ±lÄ±yor...")
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")

-- Function to find the closest player (excluding self)
local function getClosestPlayer()
    local closestHead = nil
    local minDist = math.huge
    local myPos = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") 
        and LocalPlayer.Character.HumanoidRootPart.Position 
        or Camera.CFrame.Position
    
    print("\n[HEDEF ARAMA] BaÅŸlatÄ±ldÄ±")
    print("â”œâ”€ Kendi pozisyon: " .. tostring(myPos))
    
    local validTargets = 0
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            if player.Character then
                local head = player.Character:FindFirstChild("Head")
                local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
                
                if not head then
                    print("â”œâ”€ âœ— " .. player.Name .. " - Head bulunamadÄ±")
                elseif not humanoid then
                    print("â”œâ”€ âœ— " .. player.Name .. " - Humanoid bulunamadÄ±")
                elseif humanoid.Health <= 0 then
                    print("â”œâ”€ âœ— " .. player.Name .. " - Ã–lÃ¼ (HP: 0)")
                else
                    validTargets = validTargets + 1
                    local dist = (head.Position - myPos).Magnitude
                    print("â”œâ”€ âœ“ " .. player.Name .. " - Mesafe: " .. math.floor(dist) .. " studs")
                    
                    if dist < minDist then
                        minDist = dist
                        closestHead = head
                    end
                end
            else
                print("â”œâ”€ âœ— " .. player.Name .. " - Character yok")
            end
        end
    end
    
    print("â””â”€ Toplam geÃ§erli hedef: " .. validTargets)
    
    if closestHead then
        print("\n[SONUÃ‡] âœ“ En yakÄ±n hedef bulundu!")
        print("â”œâ”€ Oyuncu: " .. closestHead.Parent.Name)
        print("â”œâ”€ Mesafe: " .. math.floor(minDist) .. " studs")
        print("â””â”€ Kafa pozisyonu: " .. tostring(closestHead.Position))
    else
        print("\n[SONUÃ‡] âœ— HiÃ§ geÃ§erli hedef yok!")
    end
    
    return closestHead
end

-- Hook __namecall metamethod
print("\n[KURULUM] __namecall metamethod hook'lanÄ±yor...")

local hookSuccess, hookError = pcall(function()
    local oldNamecall
    oldNamecall = hookmetamethod(game, "__namecall", function(self, ...)
        local method = getnamecallmethod()
        local args = {...}
        
        -- FireShot RemoteFunction'Ä±nÄ± yakala
        if method == "InvokeServer" and self.Name == "FireShot" and self.Parent and self.Parent.Name == "Sniper" then
            print("\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
            print("ğŸ”« [ATEÅ] Hook tetiklendi!")
            print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
            print("\n[ORÄ°JÄ°NAL PARAMETRELER]")
            print("â”œâ”€ StartPos (BaÅŸlangÄ±Ã§): " .. tostring(args[1]))
            print("â”œâ”€ LookVec (YÃ¶n): " .. tostring(args[2]))
            print("â””â”€ Zoom: " .. tostring(args[3]))
            
            local targetHead = getClosestPlayer()
            
            if targetHead then
                -- Kamera pozisyonundan hedefin kafasÄ±na doÄŸru yÃ¶n hesapla
                local startPos = args[1]
                local direction = (targetHead.Position - startPos).Unit
                
                -- Orijinal vektÃ¶r ile yeni vektÃ¶r arasÄ±ndaki aÃ§Ä± farkÄ±nÄ± hesapla
                local originalVec = args[2]
                local angleDiff = math.deg(math.acos(math.clamp(originalVec:Dot(direction), -1, 1)))
                
                -- LookVec'i deÄŸiÅŸtir
                args[2] = direction
                
                print("\n[MODÄ°FÄ°KASYON] âœ“ Parametreler deÄŸiÅŸtirildi!")
                print("â”œâ”€ Hedef: " .. targetHead.Parent.Name)
                print("â”œâ”€ Hedef pozisyon: " .. tostring(targetHead.Position))
                print("â”œâ”€ Yeni LookVec (YÃ¶n): " .. tostring(direction))
                print("â”œâ”€ StartPos: " .. tostring(startPos) .. " (DEÄÄ°ÅMEDÄ°)")
                print("â””â”€ AÃ§Ä± farkÄ±: " .. math.floor(angleDiff) .. "Â°")
            else
                print("\n[MODÄ°FÄ°KASYON] âš  Hedef bulunamadÄ±")
                print("â””â”€ Orijinal parametreler kullanÄ±lÄ±yor")
            end
            
            print("\n[Ã‡AÄRI] RemoteFunction Ã§aÄŸrÄ±lÄ±yor...")
            local startTime = tick()
            local result = oldNamecall(self, unpack(args))
            local elapsed = (tick() - startTime) * 1000
            
            print("[SONUÃ‡] RemoteFunction yanÄ±t verdi")
            print("â”œâ”€ DÃ¶nÃ¼ÅŸ deÄŸeri: " .. tostring(result))
            print("â””â”€ Ä°ÅŸlem sÃ¼resi: " .. math.floor(elapsed) .. "ms")
            print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n")
            
            return result
        end
        
        -- DiÄŸer tÃ¼m Ã§aÄŸrÄ±larÄ± normal ÅŸekilde geÃ§ir
        return oldNamecall(self, ...)
    end)
end)

if hookSuccess then
    print("\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
    print("âœ… BAÅARILI! __namecall hook kuruldu ve aktif.")
    print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
    print("\nSniper ile ateÅŸ etmeyi deneyin. TÃ¼m iÅŸlemler loglanacak.\n")
else
    warn("\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
    warn("âŒ BAÅARISIZ! Hook kurulamadÄ±!")
    warn("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
    warn("Hata detayÄ±: " .. tostring(hookError))
    warn("\nExecutor'Ã¼nÃ¼z hookmetamethod desteklemiyor olabilir.")
    warn("LÃ¼tfen baÅŸka bir executor deneyin (Synapse X, Script-Ware, etc.)")
end
